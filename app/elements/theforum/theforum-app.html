<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="theforum-app">
  <template>
    <style include="shared-styles"></style>
    <style include="theforum-theme"></style>
    
    <paper-drawer-panel id="paperDrawerPanel">
      <!-- Drawer Scroll Header Panel -->
      <paper-scroll-header-panel drawer fixed>

        <!-- Drawer Toolbar -->
        <paper-toolbar id="drawerToolbar">
          <span class="paper-font-title">Menu</span>
        </paper-toolbar>

        <!-- Drawer Content -->
        <paper-menu class="list" attr-for-selected="data-route" selected="[[route]]">
          <paper-submenu opened="true">
            <paper-item class="menu-trigger">Topics</paper-item>
            <paper-menu class="menu-content sublist">
              <a data-route="general" href="/general" on-click="onDataRouteClick">
                <iron-icon icon="home"></iron-icon>
                <span>General</span>
              </a>

              <a data-route="users" href="/media" on-click="onDataRouteClick">
                <iron-icon icon="info"></iron-icon>
                <span>Media</span>
              </a>

              <a data-route="events" href="/events" on-click="onDataRouteClick">
                <iron-icon icon="mail"></iron-icon>
                <span>Events</span>
              </a>
            </paper-menu>
          </paper-submenu>
        </paper-menu>

      </paper-scroll-header-panel>

      <!-- Main Area -->
      <paper-scroll-header-panel main condenses keep-condensed-header>

        <!-- Main Toolbar -->
        <paper-toolbar id="mainToolbar" class="tall">
          <paper-icon-button id="paperToggle" icon="menu" paper-drawer-toggle></paper-icon-button>
          <span class="flex"></span>

          <!-- Toolbar icons -->
          <paper-icon-button icon="refresh"></paper-icon-button>

          <!-- Application name -->
          <div class="middle middle-container center horizontal layout">
            <div class="app-name">THE FORUM</div>
          </div>

          <!-- Application sub title -->
          <div class="bottom bottom-container center horizontal layout">
            <div class="bottom-title paper-font-subhead">This is where we hang out.</div>
          </div>

        </paper-toolbar>

        <!-- Main Content -->
        <div class="content">
          <iron-pages attr-for-selected="data-route" selected="{{route}}">

            <section data-route="fresh">
              <paper-material animated elevation="1">
                <h2 class="page-title">This will be the fresh area</h2>
              </paper-material>
            </section>
            
            <section data-route="general">
              <theforum-model forum="general" posts="{{generalPosts}}"></theforum-model>
              <template is="dom-repeat" items="{{generalPosts}}" sort="sortPost">
                <paper-material animated elevation="1" class="post">
                  <theforum-post post="{{item}}"></theforum-post>
                </paper-material>  
              </template>
            </section>

            <section data-route="media">
              <theforum-model forum="media" posts="{{mediaPosts}}"></theforum-model>
              <template is="dom-repeat" items="{{mediaPosts}}">
                <paper-material animated elevation="1" class="post">
                  <theforum-post post="{{item}}"></theforum-post>
                </paper-material>  
              </template>
            </section>

            <section data-route="events">
              <paper-material elevation="1">
                <h2 class="page-title">EVENTS!!</h2>
              </paper-material>
            </section>

          </iron-pages>
        </div>
        
      </paper-scroll-header-panel>
    </paper-drawer-panel>    
  </template>
  <script>
    Polymer({
      is: 'theforum-app',
      sortPost: function(a, b) {
        var aAt = new Date(a.updated || a.modifed || a.created).getTime();
        var bAt = new Date(b.updated || b.modifed || b.created).getTime();
        if (aAt === bAt) return 0;
        return aAt < bAt ? -1 : 1;
      }
    });
  </script>
</dom-module>